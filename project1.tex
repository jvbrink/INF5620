\documentclass[a4paper, 11pt, notitlepage, english]{article}

\usepackage{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc, url}
\usepackage{textcomp}
\usepackage{amsmath, amssymb}
\usepackage{amsbsy, amsfonts}
\usepackage{graphicx, color}
\usepackage{parskip}
\usepackage{framed}
\usepackage{amsmath}
\usepackage{xcolor}
\usepackage{multicol}
\usepackage{url}
\usepackage{flafter}


\usepackage{geometry}
\geometry{headheight=0.01mm}
\geometry{top=24mm, bottom=30mm, left=39mm, right=39mm}

%
% Parametere for inkludering av kode fra fil
%
\usepackage{listings}
\lstset{language=python}
\lstset{basicstyle=\ttfamily\small}
\lstset{frame=single}
\lstset{keywordstyle=\color{red}\bfseries}
\lstset{commentstyle=\itshape\color{blue}}
\lstset{showspaces=false}
\lstset{showstringspaces=false}
\lstset{showtabs=false}
\lstset{breaklines}

%
% Definering av egne kommandoer og milj√∏er
%
\newcommand{\dd}[1]{\ \text{d}#1}
\newcommand{\f}[2]{\frac{#1}{#2}} 
\newcommand{\beq}{\begin{equation*}}
\newcommand{\eeq}{\end{equation*}}
\newcommand{\bra}[1]{\langle #1|}
\newcommand{\ket}[1]{|#1 \rangle}
\newcommand{\braket}[2]{\langle #1 | #2 \rangle}
\newcommand{\braup}[1]{\langle #1 \left|\uparrow\rangle\right.}
\newcommand{\bradown}[1]{\langle #1 \left|\downarrow\rangle\right.}
\newcommand{\av}[1]{\left| #1 \right|}
\newcommand{\op}[1]{\hat{#1}}
\newcommand{\braopket}[3]{\langle #1 | {#2} | #3 \rangle}
\newcommand{\ketbra}[2]{\ket{#1}\bra{#2}}
\newcommand{\pp}[1]{\frac{\partial}{\partial #1}}
\newcommand{\ppn}[1]{\frac{\partial^2}{\partial #1^2}}
\newcommand{\up}{\left|\uparrow\rangle\right.}
\newcommand{\upup}{\left|\uparrow\uparrow\rangle\right.}
\newcommand{\down}{\left|\downarrow\rangle\right.}
\newcommand{\downdown}{\left|\downarrow\downarrow\rangle\right.}
\newcommand{\updown}{\left|\uparrow\downarrow\rangle\right.}
\newcommand{\downup}{\left|\downarrow\uparrow\rangle\right.}
\newcommand{\bupup}{\left.\langle\uparrow\uparrow\right|}
\newcommand{\bdowndown}{\left.\langle\downarrow\downarrow\right|}
\newcommand{\bupdown}{\left.\langle\uparrow\downarrow\right|}
\newcommand{\bdownup}{\left.\langle\downarrow\uparrow\right|}
\renewcommand{\d}{{\rm d}}
\newcommand{\Res}[2]{{\rm Res}(#1;#2)}
\newcommand{\To}{\quad\Rightarrow\quad}
\newcommand{\eps}{\epsilon}
\makeatletter
\renewcommand*\env@matrix[1][*\c@MaxMatrixCols c]{%
  \hskip -\arraycolsep
  \let\@ifnextchar\new@ifnextchar
  \array{#1}}
\makeatother


\newcommand{\bt}[1]{\boldsymbol{#1}}
\newcommand{\mat}[1]{\textsf{\textbf{#1}}}
\newcommand{\I}{\boldsymbol{\mathcal{I}}}
\newcommand{\p}{\partial}
%
% Navn og tittel
%
\author{Jonas van den Brink \\ \texttt{j.v.d.brink@fys.uio.no}}
\title{Project 1 \\ INF5620}


\begin{document}
\maketitle


\section*{Description}

In this project, we will develop a general solver for the vertical motion of a body with quadratic air drag. The solver will be verified and applied to a skydiver performing a parachute jump.


\subsection*{Differential Equation}

The falling skydiver is subject to two forces: gravity and air drag. Using a quadratic model for the air drag, and applying Newton's 2. law of motion gives the differential equation
$$m\dot{v} = mg - \frac{1}{2}C_D \rho A |v| v,$$
where $C_D$ is the body's drag coefficient, $\rho$ is the density of the air and $A$ is the cross-sectional area of the body perpendicular to the motion. All of these parameters will in reality vary during a skydive. The drag coefficient and cross-sectional area due to the skydiver changing posture and the density of the air as a function of height. Starting of, we will consider all three parameters as constant throughout the skydive.

To have a tider notation, we introduce the parameter $a \equiv C_D \rho A /2$, so our ODE can be written
$$m\dot{v} = mg - a |v| v,$$


\subsection*{Numerical Scheme}
The time domain is now discretized uniformly with a step length of $\Delta t$, and the ODE sampled between two mesh points, at the time $t_{n+1/2}$. Applying a Crank-Nicolson finite difference approximation to the time derivative of the velocity gives
$$\big[D_t v = g - \frac{a}{m} \overline{(|v|v)}^t\big]^{n+1/2}.$$
Writing this out, and using a geometric average for the for the square of the velocity gives
$$\frac{v^{n+1} - v^n}{\Delta t} = g - \frac{a}{m}|v^n| v^{n+1}.$$
Solving for the unknown, $v^{n+1}$, gives the numerical scheme
$$v^{n+1} = \frac{v^n + g \Delta t}{1 + a \Delta t |v^n|/m}.$$

\subsection*{Method of Manufactured Solution}
To apply the MMS, we must first include a source term in our ODE and numerical scheme. Naming the source term $f(t)$, we get the ODE
$$m\dot{v} = mg - a |v| v + f(t).$$

To test our solver, we will attempt to reproduce an exact solution on a linear form
$$v(t) = bt + c,$$
inserting this exact solution into the ODE gives
$$mb = mg - a |bt + c| (bt + c) + f(t).$$
We can now solve to find the source term, which yields
$$f(t) = a |bt + c| (bt + c) + m(b-g).$$

The source term also needs to be included in the numerical scheme, which now looks as follows
$$v^{n+1} = \frac{v^n + g \Delta t + \Delta t f(t_{n+1/2})/m}{1 + a  \Delta t |v^n|/m}.$$
















\end{document}

